
#ifndef __NRF24L01_H__
#define __NRF24L01_H__


#include "em_usart.h"
#include "em_device.h"
#include "em_chip.h"
//#include "spidrv.h"

//NRF24L01???????
#define READ_REG_NRF        0x00  //??????,?5???????
#define WRITE_REG_NRF       0x20  //??????,?5???????
#define RD_RX_PLOAD     0x61  //?RX????,1~32??
#define WR_TX_PLOAD     0xA0  //?TX????,1~32??
#define FLUSH_TX        0xE1  //??TX FIFO???.??????
#define FLUSH_RX        0xE2  //??RX FIFO???.??????
#define REUSE_TX_PL     0xE3  //?????????,CE??,????????.
#define NOP             0xFF  //???,??????????	 
//SPI(NRF24L01)?????
#define CONFIG          0x00  //???????;bit0:1????,0????;bit1:???;bit2:CRC??;bit3:CRC??;
                              //bit4:??MAX_RT(??????????)??;bit5:??TX_DS??;bit6:??RX_DR??
#define EN_AA           0x01  //????????  bit0~5,????0~5
#define EN_RXADDR       0x02  //??????,bit0~5,????0~5
#define SETUP_AW        0x03  //??????(??????):bit1,0:00,3??;01,4??;02,5??;
#define SETUP_RETR      0x04  //??????;bit3:0,???????;bit7:4,?????? 250*x+86us
#define RF_CH           0x05  //RF??,bit6:0,??????;
#define RF_SETUP        0x06  //RF???;bit3:????(0:1Mbps,1:2Mbps);bit2:1,????;bit0:????????
#define STATUS          0x07  //?????;bit0:TX FIFO???;bit3:1,???????(??:6);bit4,???????
                              //bit5:????????;bit6:??????;
#define MAX_TX  		0x10  //??????????
#define TX_OK   		0x20  //TX??????
#define RX_OK   		0x40  //???????

#define OBSERVE_TX      0x08  //???????,bit7:4,????????;bit3:0,?????
#define CD              0x09  //???????,bit0,????;
#define RX_ADDR_P0      0x0A  //????0????,????5???,?????
#define RX_ADDR_P1      0x0B  //????1????,????5???,?????
#define RX_ADDR_P2      0x0C  //????2????,???????,???,???RX_ADDR_P1[39:8]??;
#define RX_ADDR_P3      0x0D  //????3????,???????,???,???RX_ADDR_P1[39:8]??;
#define RX_ADDR_P4      0x0E  //????4????,???????,???,???RX_ADDR_P1[39:8]??;
#define RX_ADDR_P5      0x0F  //????5????,???????,???,???RX_ADDR_P1[39:8]??;
#define TX_ADDR         0x10  //????(?????),ShockBurstTM???,RX_ADDR_P0??????
#define RX_PW_P0        0x11  //??????0??????(1~32??),???0???
#define RX_PW_P1        0x12  //??????1??????(1~32??),???0???
#define RX_PW_P2        0x13  //??????2??????(1~32??),???0???
#define RX_PW_P3        0x14  //??????3??????(1~32??),???0???
#define RX_PW_P4        0x15  //??????4??????(1~32??),???0???
#define RX_PW_P5        0x16  //??????5??????(1~32??),???0???
#define NRF_FIFO_STATUS 0x17  //FIFO?????;bit0,RX FIFO??????;bit1,RX FIFO???;bit2,3,??
                              //bit4,TX FIFO???;bit5,TX FIFO???;bit6,1,?????????.0,???;


//24L01??????????
#define TX_ADR_WIDTH    5   	//5???????
#define RX_ADR_WIDTH    5   	//5???????
#define TX_PLOAD_WIDTH  30  	//32?????????
#define RX_PLOAD_WIDTH  30  	//32?????????





	#define Nrf24l01_HI_SPI_FREQ     8000000

	#define Nrf24l01_LO_SPI_FREQ     1000000
	#define Nrf24l01_USART           USART0

	#define Nrf24l01_CMUCLOCK        cmuClock_USART0
	#define Nrf24l01_GPIOPORT        gpioPortC
	#define Nrf24l01_MOSIPIN         0
	#define Nrf24l01_MOSI_LOC        USART_ROUTE_LOCATION_LOC0
	#define Nrf24l01_MISOPIN         1
	#define Nrf24l01_MISO_LOC        USART_ROUTE_LOCATION_LOC0
	#define Nrf24l01_CSPIN           2
	#define Nrf24l01_CLKPIN          14
	#define Nrf24l01_CLK_LOC         USART_ROUTE_LOCATION_LOC3
	#define Nrf24l01_CEPIN           3
	
	

	
void Nrf24l01_init(void);
void Nrf24l01_transmit(uint8_t* data,uint8_t size);
void Nrf24l01_recv(void);
uint8_t NRF_Write_reg(uint8_t add,uint8_t* data,uint8_t size);
uint8_t NRF_Read_reg(uint8_t add);
void Config_transmitter(void);
void Config_reciever(void);
void delay_ms(uint16_t ms);	
void delay_(void);
void multi_read(uint8_t reg,uint8_t* p,uint8_t size);
void NRF24L01_RX_Mode(void);
uint8_t NRF24L01_Write_Buf(uint8_t reg, uint8_t *pBuf, uint8_t len);		
uint8_t NRF_Write_reg2(uint8_t add,uint8_t data);
uint8_t NRF24L01_RxPacket(uint8_t *rxbuf);
#endif